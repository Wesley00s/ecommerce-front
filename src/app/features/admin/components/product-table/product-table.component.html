<div
   class="hidden md:block relative overflow-hidden shadow-lg sm:rounded-xl bg-white border border-gray-100"
>
   <table class="w-full text-sm text-left text-gray-500">
      <thead
         class="text-xs text-gray-500 uppercase bg-gray-50/80 border-b border-gray-100"
      >
         <tr>
            <th scope="col" class="px-6 py-4 font-semibold tracking-wider">
               Produto
            </th>
            <th scope="col" class="px-6 py-4 font-semibold tracking-wider">
               Categoria
            </th>
            <th scope="col" class="px-6 py-4 font-semibold tracking-wider">
               Preço
            </th>
            <th scope="col" class="px-6 py-4 font-semibold tracking-wider">
               Estoque
            </th>
            <th
               scope="col"
               class="px-6 py-4 text-right font-semibold tracking-wider"
            >
               Ações
            </th>
         </tr>
      </thead>
      <tbody class="divide-y divide-gray-100">
         @for (product of products; track product.id) {
            <tr
               class="bg-white hover:bg-blue-50/30 transition-colors duration-200 group"
            >
               <td class="px-6 py-4">
                  <div class="flex items-center gap-4">
                     <a
                        [routerLink]="['/products/details', product.code]"
                        class="h-12 w-12 rounded-lg overflow-hidden border border-gray-200 shadow-sm shrink-0 cursor-pointer hover:opacity-80 transition-opacity"
                        title="Ver detalhes do produto"
                     >
                        <img
                           [ngSrc]="product.coverImageUrl"
                           [alt]="product.name"
                           class="w-full h-full object-cover"
                           width="100"
                           height="100"
                        />
                     </a>

                     <div class="min-w-0">
                        <div
                           class="font-medium text-gray-900 truncate max-w-[200px]"
                           title="{{ product.name }}"
                        >
                           {{ product.name }}
                        </div>
                        <div class="text-xs text-gray-500 font-mono mt-0.5">
                           {{ product.code || "N/A" }}
                        </div>
                     </div>
                  </div>
               </td>

               <td class="px-6 py-4 whitespace-nowrap text-gray-600">
                  {{ product.categoryName }}
               </td>

               <td
                  class="px-6 py-4 whitespace-nowrap font-medium text-gray-900"
               >
                  {{ product.price | currency: "BRL" }}
               </td>

               <td class="px-6 py-4 whitespace-nowrap">
                  @if (product.stock > 0) {
                     <span
                        class="inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-medium bg-green-50 text-green-700 border border-green-100"
                     >
                        <span
                           class="w-1.5 h-1.5 rounded-full bg-green-500"
                        ></span>
                        {{ product.stock }} un
                     </span>
                  } @else {
                     <span
                        class="inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-medium bg-red-50 text-red-700 border border-red-100"
                     >
                        <span
                           class="w-1.5 h-1.5 rounded-full bg-red-500"
                        ></span>
                        Esgotado
                     </span>
                  }
               </td>

               <td class="px-6 py-4 text-right">
                  <div class="flex items-center justify-end gap-2">
                     <button
                        (click)="edit.emit(product)"
                        class="p-2 rounded-lg text-blue-600 hover:bg-blue-100 transition-all duration-200"
                        title="Editar"
                     >
                        <img
                           src="assets/icons/edit.svg"
                           class="w-5 h-5"
                           alt="Edit"
                        />
                     </button>
                     <button
                        (click)="delete.emit(product.id!)"
                        class="p-2 rounded-lg text-gray-400 hover:bg-red-100 hover:text-red-600 transition-all duration-200"
                        title="Excluir"
                     >
                        <img
                           src="assets/icons/delete.svg"
                           class="w-5 h-5"
                           alt="Delete"
                        />
                     </button>
                  </div>
               </td>
            </tr>
         } @empty {
            <tr>
               <td colspan="5" class="px-6 py-12 text-center text-gray-500">
                  <div class="flex flex-col items-center justify-center gap-2">
                     <svg
                        xmlns="http://www.w3.org/2000/svg"
                        fill="none"
                        viewBox="0 0 24 24"
                        stroke-width="1.5"
                        stroke="currentColor"
                        class="w-10 h-10 text-gray-300"
                     >
                        <path
                           stroke-linecap="round"
                           stroke-linejoin="round"
                           d="M20.25 7.5l-.625 10.632a2.25 2.25 0 01-2.247 2.118H6.622a2.25 2.25 0 01-2.247-2.118L3.75 7.5M10 11.25h4M3.375 7.5h17.25c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125z"
                        />
                     </svg>
                     <span>Nenhum produto encontrado.</span>
                  </div>
               </td>
            </tr>
         }
      </tbody>
   </table>
</div>

<div class="grid grid-cols-1 gap-4 md:hidden">
   @for (product of products; track product.id) {
      <div
         class="bg-white shadow-sm rounded-xl p-4 border border-gray-200 flex flex-col gap-4"
      >
         <div class="flex gap-4">
            <div
               class="w-20 h-20 rounded-lg overflow-hidden border border-gray-100 shrink-0"
            >
               <a
                  [routerLink]="['/products/details', product.code]"
                  class="w-full h-full object-cover"
                  width="200"
                  height="200"
                  title="Ver detalhes do produto"
               >
                  <img
                     [ngSrc]="product.coverImageUrl"
                     [alt]="product.name"
                     class="w-full h-full object-cover"
                     width="100"
                     height="100"
                  />
               </a>
            </div>
            <div class="flex-1 min-w-0 flex flex-col justify-between">
               <div>
                  <p
                     class="text-xs font-semibold text-blue-600 uppercase tracking-wider mb-0.5 truncate"
                  >
                     {{ product.categoryName }}
                  </p>
                  <h3
                     class="font-bold text-gray-900 text-base leading-tight line-clamp-2"
                  >
                     {{ product.name }}
                  </h3>
               </div>

               <div class="font-bold text-lg text-gray-900">
                  {{ product.price | currency: "BRL" }}
               </div>
            </div>
         </div>

         <div class="grid grid-cols-2 gap-2 bg-gray-50 p-3 rounded-lg text-sm">
            <div>
               <span class="text-gray-500 text-xs uppercase block"
                  >Estoque</span
               >
               @if (product.stock > 0) {
                  <span class="font-medium text-green-700"
                     >{{ product.stock }} un</span
                  >
               } @else {
                  <span class="font-medium text-red-600">Esgotado</span>
               }
            </div>

            <div class="min-w-0">
               <span class="text-gray-500 text-xs uppercase block">Código</span>
               <span
                  class="font-mono text-gray-700 block truncate"
                  title="{{ product.code }}"
               >
                  {{ product.code || "-" }}
               </span>
            </div>
         </div>

         <div class="grid grid-cols-2 gap-3 pt-2">
            <button
               (click)="edit.emit(product)"
               class="flex items-center justify-center gap-2 px-4 py-2.5 text-sm font-medium text-blue-700 bg-blue-50 rounded-lg hover:bg-blue-100 active:scale-95 transition-all"
            >
               <svg
                  xmlns="http://www.w3.org/2000/svg"
                  viewBox="0 0 20 20"
                  fill="currentColor"
                  class="w-4 h-4"
               >
                  <path
                     d="M5.433 13.917l1.262-3.155A4 4 0 017.58 9.42l6.92-6.918a2.121 2.121 0 013 3l-6.92 6.918c-.383.383-.84.685-1.343.886l-3.154 1.262a.5.5 0 01-.65-.65z"
                  />
                  <path
                     d="M3.5 5.75c0-.69.56-1.25 1.25-1.25H10A.75.75 0 0010 3H4.75A2.75 2.75 0 002 5.75v9.5A2.75 2.75 0 004.75 18h9.5A2.75 2.75 0 0017 15.25V10a.75.75 0 00-1.5 0v5.25c0 .69-.56 1.25-1.25 1.25h-9.5c-.69 0-1.25-.56-1.25-1.25v-9.5z"
                  />
               </svg>
               Editar
            </button>
            <button
               (click)="delete.emit(product.id!)"
               class="flex items-center justify-center gap-2 px-4 py-2.5 text-sm font-medium text-red-700 bg-red-50 rounded-lg hover:bg-red-100 active:scale-95 transition-all"
            >
               <svg
                  xmlns="http://www.w3.org/2000/svg"
                  viewBox="0 0 20 20"
                  fill="currentColor"
                  class="w-4 h-4"
               >
                  <path
                     fill-rule="evenodd"
                     d="M8.75 1A2.75 2.75 0 006 3.75v.443c-.795.077-1.584.176-2.365.298a.75.75 0 10.23 1.482l.149-.022.841 10.518A2.75 2.75 0 007.596 19h4.807a2.75 2.75 0 002.742-2.53l.841-10.52.149.023a.75.75 0 00.23-1.482A41.03 41.03 0 0014 4.193V3.75A2.75 2.75 0 0011.25 1h-2.5zM10 4c.84 0 1.673.025 2.5.075V3.75c0-.69-.56-1.25-1.25-1.25h-2.5c-.69 0-1.25.56-1.25 1.25v.325C8.327 4.025 9.16 4 10 4zM8.58 7.72a.75.75 0 00-1.5.06l.3 7.5a.75.75 0 101.5-.06l-.3-7.5zm4.34.06a.75.75 0 10-1.5-.06l-.3 7.5a.75.75 0 101.5.06l.3-7.5z"
                     clip-rule="evenodd"
                  />
               </svg>
               Excluir
            </button>
         </div>
      </div>
   } @empty {
      <div
         class="text-center py-8 bg-gray-50 rounded-lg border border-dashed border-gray-300"
      >
         <p class="text-gray-500">Nenhum produto encontrado.</p>
      </div>
   }
</div>
